webpackJsonp([29],{309:function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar API_SAVE_PROPERTY = APIS.API_MY_UPDATE_PROFILE;\n\nvar Index = function (_Quyou) {\n    _inherits(Index, _Quyou);\n\n    function Index() {\n        var _ref;\n\n        var _temp, _this, _ret;\n\n        _classCallCheck(this, Index);\n\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n        }\n\n        return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Index.__proto__ || Object.getPrototypeOf(Index)).call.apply(_ref, [this].concat(args))), _this), _this.state = {\n            showCreateComment: false,\n            textOkay: _this.initTextOkay,\n            user: _this.user,\n            uploadText: '上传头像',\n            currentProperty: ''\n        }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    _createClass(Index, [{\n        key: 'handleSaveComment',\n        value: function handleSaveComment(_ref2, e) {\n            var API_SAVE_PROPERTY = _ref2.API_SAVE_PROPERTY,\n                _ref2$property = _ref2.property,\n                property = _ref2$property === undefined ? 'nickname' : _ref2$property,\n                _ref2$query = _ref2.query,\n                query = _ref2$query === undefined ? {} : _ref2$query;\n\n            var me = this;\n            var state = me.state,\n                initTextOkay = me.initTextOkay;\n            var valueCreateComment = state.valueCreateComment,\n                textOkay = state.textOkay;\n            var params = me.props.params;\n\n            if (textOkay === initTextOkay && valueCreateComment) {\n                var _extends2;\n\n                me.setState({\n                    textOkay: initTextOkay + '\\u4E2D...'\n                });\n                me.requestAPI(API_SAVE_PROPERTY, _extends({}, query, (_extends2 = {}, _defineProperty(_extends2, property, valueCreateComment), _defineProperty(_extends2, 'token', me.user.token), _extends2)), function (response) {\n                    var _response$code = response.code,\n                        code = _response$code === undefined ? 0 : _response$code,\n                        data = response.data;\n\n                    if (code) {\n                        me.setState({\n                            textOkay: initTextOkay\n                        });\n                        return;\n                    }\n                    var user = _extends({}, me.user, data);\n                    me.setState({\n                        textOkay: initTextOkay,\n                        showCreateComment: false,\n                        valueCreateComment: '',\n                        user: user\n                    });\n                    misc.setCookie('user', JSON.stringify(user));\n                });\n            }\n        }\n    }, {\n        key: 'getCurrentProperty',\n        value: function getCurrentProperty() {\n            return this.currentProperty;\n        }\n    }, {\n        key: 'renderContent',\n        value: function renderContent() {\n            var me = this;\n            var _me$state = me.state,\n                showCreateComment = _me$state.showCreateComment,\n                textOkay = _me$state.textOkay,\n                my = _me$state.user,\n                uploadText = _me$state.uploadText,\n                currentProperty = _me$state.currentProperty;\n\n            console.log('currentProperty', currentProperty);\n            return React.createElement(\n                'div',\n                { className: 'my-profile' },\n                currentProperty === 'nickname' && showCreateComment ? React.createElement(CreateComment, {\n                    defaultValue: my['nickname'],\n                    maxLength: 20,\n                    textPlaceholder: '\\u60F3\\u4E00\\u4E2A\\u6709\\u610F\\u601D\\u7684\\u6635\\u79F0\\u5427\\uFF5E',\n                    textTitle: '\\u4FEE\\u6539\\u6635\\u79F0',\n                    textOkay: textOkay,\n                    handleClickCancel: me.handleShowCreateComment.bind(me, {\n                        currentProperty: ''\n                    }),\n                    handleClickOkay: me.handleSaveComment.bind(me, { API_SAVE_PROPERTY: API_SAVE_PROPERTY, property: 'nickname', query: {\n                            headimg: my.headimg,\n                            psign: my.psign || ''\n                        } }),\n                    handleChangeInput: me.handleChangeCreateComment.bind(me) }) : null,\n                currentProperty === 'psign' && showCreateComment ? React.createElement(CreateComment, {\n                    defaultValue: my['psign'],\n                    maxLength: 20,\n                    textPlaceholder: '\\u60F3\\u4E00\\u4E2A\\u6709\\u610F\\u601D\\u7684\\u4E2A\\u6027\\u7B7E\\u540D\\u5427\\uFF5E',\n                    textTitle: '\\u4FEE\\u6539\\u4E2A\\u6027\\u7B7E\\u540D',\n                    textOkay: textOkay,\n                    handleClickCancel: me.handleShowCreateComment.bind(me, {\n                        currentProperty: ''\n                    }),\n                    handleClickOkay: me.handleSaveComment.bind(me, { API_SAVE_PROPERTY: API_SAVE_PROPERTY, property: 'psign', query: {\n                            headimg: my.headimg,\n                            nickname: my.nickname\n                        } }),\n                    handleChangeInput: me.handleChangeCreateComment.bind(me) }) : null,\n                React.createElement(\n                    'ul',\n                    { className: 'link-list' },\n                    React.createElement(\n                        'li',\n                        { className: 'avatarbox' },\n                        React.createElement('div', { className: 'icon avatar', style: { backgroundImage: 'url(' + (my.headimg || avatar_url) + ')' } }),\n                        React.createElement(\n                            'div',\n                            { className: 'arrow-box' },\n                            React.createElement('span', { className: 'icon' })\n                        ),\n                        React.createElement(\n                            'div',\n                            { className: 'text' },\n                            uploadText\n                        ),\n                        React.createElement('div', { className: 'thinner-border clearboth' }),\n                        React.createElement(\n                            'form',\n                            { encType: 'multipart/form-data', id: 'headimgform' },\n                            React.createElement('input', { type: 'file', name: 'file', accept: 'image/png,image/jpg,image/jpeg,image/gif', onChange: me.upload.bind(me, { API_SAVE_PROPERTY: API_SAVE_PROPERTY, property: 'headimg', query: {\n                                        nickname: my.nickname\n                                    } }) })\n                        )\n                    ),\n                    React.createElement(\n                        'li',\n                        null,\n                        React.createElement(\n                            'div',\n                            { className: 'name' },\n                            '\\u624B\\u673A'\n                        ),\n                        React.createElement('div', { className: 'arrow-box' }),\n                        React.createElement(\n                            'div',\n                            { className: 'text' },\n                            my.mobile\n                        ),\n                        React.createElement('div', { className: 'thinner-border clearboth' })\n                    ),\n                    React.createElement(\n                        'li',\n                        null,\n                        React.createElement(\n                            'div',\n                            { className: 'name' },\n                            '\\u6635\\u79F0'\n                        ),\n                        React.createElement(\n                            'div',\n                            { className: 'arrow-box', onClick: me.handleShowCreateComment.bind(me, {\n                                    currentProperty: 'nickname'\n                                }) },\n                            React.createElement('span', { className: 'icon' })\n                        ),\n                        React.createElement(\n                            'div',\n                            { className: 'text', onClick: me.handleShowCreateComment.bind(me, {\n                                    currentProperty: 'nickname'\n                                }) },\n                            my.nickname\n                        ),\n                        React.createElement('div', { className: 'thinner-border clearboth' })\n                    ),\n                    React.createElement(\n                        'li',\n                        null,\n                        React.createElement(\n                            'div',\n                            { className: 'name' },\n                            '\\u4E2A\\u6027\\u7B7E\\u540D'\n                        ),\n                        React.createElement(\n                            'div',\n                            { className: 'arrow-box', onClick: me.handleShowCreateComment.bind(me, {\n                                    currentProperty: 'psign'\n                                }) },\n                            React.createElement('span', { className: 'icon' })\n                        ),\n                        React.createElement(\n                            'div',\n                            { className: 'text text-elip', onClick: me.handleShowCreateComment.bind(me, {\n                                    currentProperty: 'psign'\n                                }) },\n                            my.psign || '\\u672C\\u5B9D\\u5B9D\\u6682\\u65F6\\u8FD8\\u6CA1\\u60F3\\u5230\\u4E2A\\u6027\\u7684\\u7B7E\\u540D'\n                        ),\n                        React.createElement('div', { className: 'thinner-border clearboth' })\n                    )\n                )\n            );\n        }\n    }, {\n        key: 'upload',\n        value: function upload(_ref3) {\n            var API_SAVE_PROPERTY = _ref3.API_SAVE_PROPERTY,\n                _ref3$property = _ref3.property,\n                property = _ref3$property === undefined ? 'headimg' : _ref3$property,\n                _ref3$query = _ref3.query,\n                query = _ref3$query === undefined ? {} : _ref3$query;\n\n            var me = this;\n            var uploadText = me.state.uploadText;\n\n            if (uploadText === '\\u4E0A\\u4F20\\u4E2D...') return false;\n            me.setState({\n                uploadText: '\\u4E0A\\u4F20\\u4E2D...'\n            });\n            var fail = function fail() {\n                me.setState({\n                    uploadText: '\\u4E0A\\u4F20\\u5931\\u8D25\\uFF0C\\u91CD\\u65B0\\u4E0A\\u4F20'\n                });\n            };\n            var form = new FormData(document.getElementById('headimgform'));\n            var oReq = new XMLHttpRequest();\n            // oReq.open(\"POST\", \"/peanut/fileUpload\", true)\n            oReq.open(\"POST\", \"http://quyou.weichongming.com/peanut/fileUpload\", true);\n            oReq.onload = function (oEvent) {\n                console.log(oReq);\n                if (oReq.status === 200) {\n                    // debugger\n                    // const res = {url: \"http://upyun.wocaoapp.com.com/prod_00/2caa03cd39ecd102.png\", code: 0}\n                    var res = JSON.parse(oReq.response);\n                    // console.log(res)\n                    if (res.code === 0) {\n                        var _extends3;\n\n                        me.requestAPI(API_SAVE_PROPERTY, _extends({}, query, (_extends3 = {}, _defineProperty(_extends3, property, res.url), _defineProperty(_extends3, 'token', me.user.token), _extends3)), function (response) {\n                            var _response$code2 = response.code,\n                                code = _response$code2 === undefined ? 0 : _response$code2,\n                                data = response.data;\n\n                            if (code) {\n                                fail && fail();\n                                return;\n                            }\n                            var user = _extends({}, me.user, data);\n                            me.setState({\n                                uploadText: '\\u4E0A\\u4F20\\u6210\\u529F\\uFF0C\\u91CD\\u65B0\\u4E0A\\u4F20',\n                                user: user\n                            });\n                            misc.setCookie('user', JSON.stringify(user));\n                        });\n                    } else {\n                        fail && fail();\n                    }\n                } else {\n                    fail && fail();\n                }\n            };\n            oReq.send(form);\n        }\n    }]);\n\n    return Index;\n}(Quyou);\n\nexports.default = Index;\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/quyou/MyProfile.js\n// module id = 309\n// module chunks = 29\n\n//# sourceURL=webpack:///./src/pages/quyou/MyProfile.js?")}});